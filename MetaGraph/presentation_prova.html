 <!doctype html>
 <meta charset="utf-8"/>
 <html>
 <head>
     <title>Neovis.js Simple Example</title>
     <style type="text/css">
        html, body {
            font: 16pt arial;
        }

        #viz {
            width: 100%;
            height: 900px;
            border: 1px solid white;
            font: 22pt arial;
            background: white;
        }
        /* Set additional styling options for the columns*/
        .column {
        float: left;
        width: 50%;
        }
    
        .row:after {
        content: "";
        display: table;
        clear: both;
        }
        </style>
     </style>

     <script type="text/javascript" src="https://rawgit.com/neo4j-contrib/neovis.js/master/dist/neovis.js">                                    
     </script>


      <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>

     <script type="text/javascript">
    
        var viz;
         function draw() {
          var config = {
            container_id: "viz",
            server_url: "bolt://localhost:7687",
            server_user: "neo4j",
            server_password: "1234",
            physics: {
                    enabled: true,
                    barnesHut: {
                        springConstant: 0,
                        avoidOverlap: 0.1
                    }
            },
            labels: {
                "Publication": {
                    "caption": "subtitle",
                    "size": "pageRank",
                    "community": "community",
                        "title_properties": [
                        "title",
                        "year",
                        "pageRank",
                        "community",
                        "community_METHODS"
                        
                    ]
                },
                "InferedTool": {
                    "caption": "name",
                    "size": "pageRank",
                    "community": "community",
                    "title_properties": [
                        "name",
                        "keywords",
                        "community",
                        "community_METHODS"
                    ]
                },
                "Community": {
                    "caption": "com_id",
                    "size": "pageRank",
                    "community": "community",
                    "title_properties": [
                        "name",
                        "keywords",
                        "community"
                    ]
                }
            },
            relationships: {
                "METAOCCUR": {
                    "thickness": "times",
                    "caption": "year"
                },
                "METAOCCUR_ALL": {
                    "thickness": "times",
                    "caption": "times"
                },
                "METAOCCUR_METHODS_ALL": {
                    "thickness": "times",
                    "caption": "times"
                },
                "HAS_TOOL": {
                    "caption": false
                }                    ,
                "METAOCCUR_COMM": {
                    "thickness": "times",
                    "caption": false
                }
            },           
           initial_cypher :" CALL{ MATCH (i:InferedTool)-[o:METAOCCUR]->(p) WITH p,i, collect(o) as co UNWIND co as c WITH sum(c.times) as sumo, p,i, co RETURN i,co,p,sumo ORDER BY sumo DESC LIMIT 100} WITH i,co,p, sumo UNWIND co as c WITH i,p,sumo,c WHERE c.year = 2006 RETURN i,p,sumo,c"  ,                 
           arrows: false
            };
            viz = new NeoVis.default(config);
            viz.render();
            console.log(viz);
             }
        </script>
        </head>
      <body onload="draw()">
      <div id="viz"></div>


    <div class="row">
        <div class="column" style="background-color:#FFB695;">
            Update Cypher query: <textarea rows="4" cols=50 id="updatecypher"></textarea><br>
            <input type="submit" value="Submit" id="reload">
            <input type="submit" value="Stabilize" id="stabilize"> 
        </div>
        <div class="column" style="background-color:#96D1CD;">
            Redo Cypher query: <textarea rows="4" cols=50 id="redocypher"></textarea><br>
            <input type="submit" value="Submit" id="redoreload">
        </div>
    </div>


     </body>

     <script>

       $("#reload").click(function() {
       var cypher = $("#updatecypher").val();
        if (cypher.length > 3) {
        viz.updateWithCypher(cypher);
          } else {
        console.log("#reload");
        viz.reload();
          }
         });
        $("#stabilize").click(function() {
         viz.stabilize();
        })
    </script>
    <script>

       $("#redoreload").click(function() {
       var cypher = $("#redocypher").val();
        if (cypher.length > 3) {
        viz.renderWithCypher(cypher);
          } else {
        console.log("redoreload");
        viz.reload();
          }
         });
    </script>
    <frameset cols="50%,50%">
      <frame src="frame_a.htm" frameborder="0">
      <frame src="frame_b.htm" frameborder="0">
    </frameset>
    </html>
